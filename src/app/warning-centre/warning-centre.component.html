<div class="top-bar">
  <!-- ICON BUTTON -->
  <button
    pButton
    type="button"
    class="alert-icon-btn"
    [ngClass]="(borderClass$ | async)!"
    icon="pi pi-exclamation-triangle"
    (click)="panel.toggle($event)"
  ></button>

  <!-- LABEL BUTTON -->
  <button
    pButton
    type="button"
    class="alert-label-btn"
    label="Client enquiry"
  ></button>

  <p-dropdown
    class="top-select"
    [options]="customerTypes"
    [(ngModel)]="customerType"
    optionLabel="label"
    styleClass="top-select-inner"
  ></p-dropdown>

  <button
    pButton
    type="button"
    label="Calculate"
    class="top-calc-btn"
  ></button>
</div>

<p-overlayPanel #panel [dismissable]="true" [showCloseIcon]="true">
  <ng-container *ngIf="(messages$ | async) as messages">
    <div class="error-panel" *ngIf="messages.length; else allGood">
      <div class="error-header">
        <i class="pi pi-exclamation-circle"></i>
        <span class="title">
          Errors ({{ (counts$ | async)?.error ?? 0 }}) â€“ require your attention
        </span>
        <a class="clear" (click)="onClearAll($event)">Clear all</a>
      </div>

      <div class="error-list">
        <div
          *ngFor="let msg of messages; let i = index"
          class="error-item"
          [ngClass]="{ main: i === 0 }"
        >
          <span class="error-bullet">!</span>
          <div class="msg-text">{{ msg.text }}</div>
          <button
            pButton
            type="button"
            icon="pi pi-times"
            class="close-btn p-button-rounded p-button-text"
            (click)="onRemove(msg.id)"
          ></button>
        </div>
      </div>
    </div>

    <ng-template #allGood>
      <div class="error-panel ok">
        <div class="error-header">
          <i class="pi pi-check-circle"></i>
          <span class="title">All good â€“ no validation messages ðŸŽ‰</span>
        </div>
      </div>
    </ng-template>
  </ng-container>
</p-overlayPanel>
